package me.Minecraftmage113.InsanityPlugin.listeners;

import org.bukkit.Material;
import org.bukkit.OfflinePlayer;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.entity.EntityDamageByEntityEvent;
import org.bukkit.event.entity.EntityDamageEvent;
import org.bukkit.event.entity.EntityDamageEvent.DamageCause;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.meta.SkullMeta;

import me.Minecraftmage113.InsanityPlugin.Main;

public class ListenerEntityDamage extends InsanityListener {
	public ListenerEntityDamage(Main plugin) { super(plugin); }
	
	@EventHandler
	public void onHit(EntityDamageByEntityEvent event) {
		if(event.getDamager() instanceof Player) {
			Player p = (Player) event.getDamager();
			ItemStack item = p.getInventory().getItemInMainHand();
			if(item!=null) {
				if(Main.ModelData.DEPRESSION_WAND.instance(item)) {
					saddify(event, p);
				} else if(Main.ModelData.REAPERS_SCYTHE.instance(item)) {
					behead(event, p);
				} else if(Main.ModelData.LASSOO.instance(item)) {
					lassoo(event, p, );
				}
			}
		}
	}
	
	public void lassoo() {
		
	}
	
	public void behead(EntityDamageByEntityEvent event, Player p) {
		if(event.getEntity() instanceof Player) {
			ItemStack head = new ItemStack(Material.PLAYER_HEAD);
			SkullMeta meta = (SkullMeta) head.getItemMeta();
			meta.setOwningPlayer((OfflinePlayer) event.getEntity());
			head.setItemMeta(meta);
			p.getInventory().addItem(head);
		}
	}
	
	public void saddify(EntityDamageByEntityEvent event) {
		event.getEntity().setLastDamageCause(new EntityDamageEvent(event.getEntity(), DamageCause.SUICIDE, 10));
		event.setDamage(0);
	}
}
